<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Huella de Carbono - Taller EcolÃ³gico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", system-ui, sans-serif;
      background: linear-gradient(135deg, #dcfce7, #bbf7d0, #86efac);
      color: #064e3b;
    }

    .container {
      max-width: 960px;
      margin: auto;
      padding: 24px;
    }

    .eco-title {
      text-align: center;
      font-size: 28px;
      margin-bottom: 20px;
      color: #064e3b;
      font-weight: bold;
    }

    .eco-card {
      background: #f0fdf4;
      border: 2px solid #22c55e;
      border-radius: 22px;
      padding: 22px;
      margin-bottom: 24px;
      box-shadow: 0 12px 24px rgba(22, 101, 52, 0.15);
    }

    .eco-card h2 {
      margin-top: 0;
      color: #065f46;
    }

    .eco-box {
      background: #dcfce7;
      border-left: 6px solid #22c55e;
      padding: 18px;
      border-radius: 14px;
      font-size: 15px;
      line-height: 1.7;
    }

    .eco-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .btn-eco {
      margin-top: 16px;
      display: inline-block;
      background: linear-gradient(135deg, #16a34a, #22c55e);
      color: #ffffff;
      text-decoration: none;
      padding: 14px 24px;
      border-radius: 999px;
      font-size: 15px;
      font-weight: bold;
      box-shadow: 0 6px 16px rgba(0,0,0,0.15);
      transition: all .15s ease;
    }

    .btn-eco:hover {
      transform: scale(1.05);
      background: linear-gradient(135deg, #15803d, #16a34a);
    }

    canvas {
      width: 100%;
      height: 240px;
      border-radius: 18px;
      border: 2px solid #22c55e;
      background: #ecfdf5;
    }

    .eco-values {
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      color: #065f46;
    }

    .eco-label {
      text-align: center;
      font-size: 14px;
      color: #166534;
    }
  </style>
</head>
<body>

<div class="container">

  <div class="eco-title">ðŸŒ¿ Huella de Carbono Digital del Taller</div>

  <!-- MÃ‰TRICAS -->
  <div class="eco-card">
    <h2>ðŸŒŽ Impacto ambiental de esta pÃ¡gina</h2>
    <p class="eco-label">Datos transferidos</p>
    <p class="eco-values" id="dataSize">Cargando...</p>

    <p class="eco-label">COâ‚‚ generado por visita</p>
    <p class="eco-values"><span id="co2">0</span> g COâ‚‚e</p>

    <p class="eco-label">COâ‚‚ por 1000 visitas</p>
    <p class="eco-values"><span id="co2Month">0</span> g COâ‚‚e</p>
  </div>

  <!-- GRÃFICA -->
  <div class="eco-card">
    <h2>ðŸ“Š GrÃ¡fica de impacto</h2>
    <canvas id="grafica"></canvas>
  </div>

  <!-- CUADROS 2X2 -->
  <div class="eco-card">
    <h2>ðŸŒ± Compromiso EcolÃ³gico del Taller</h2>

    <div class="eco-grid">
      <div class="eco-box">
        <b>Â¿QuÃ© es la huella de carbono?</b><br><br>
        Es la medida de las emisiones de gases contaminantes generadas directa o
        indirectamente por nuestras actividades, incluido el uso de servicios digitales.
      </div>

      <div class="eco-box">
        <b>ReparaciÃ³n para reducir contaminaciÃ³n</b><br><br>
        Nuestro taller repara equipos electrÃ³nicos para evitar que terminen como
        residuos electrÃ³nicos, disminuyendo la contaminaciÃ³n ambiental.
      </div>

      <div class="eco-box">
        <b>Compromiso ambiental</b><br><br>
        Utilizamos procesos responsables, fomentamos la reutilizaciÃ³n de piezas y
        aplicamos prÃ¡cticas de ahorro energÃ©tico en cada servicio.
      </div>

      <div class="eco-box">
        <b>PolÃ­tica Ã©tica y legal</b><br><br>
        Operamos bajo principios de Ã©tica profesional, honestidad, confidencialidad
        y respeto a nuestros clientes, cuidando la transparencia y la confianza.
        <br><br>
        <a href="{% url 'terminos' %}" class="btn-eco">
          ðŸ“„ Ver TÃ©rminos y Condiciones
        </a>
      </div>
    </div>
  </div>

</div>

<script>
// --- Valores Fijos de SimulaciÃ³n ---
// Usaremos valores base que simulan un sitio web de tamaÃ±o medio.
// Si deseas un valor base diferente para tu pÃ¡gina, puedes ajustarlos.
const TAMANO_BASE_KB = 550; // 550 KB de transferencia (Valor fijo)
const CO2_BASE_POR_VISITA = 0.00003; // g COâ‚‚e (Valor fijo)

window.onload = function () {
    
    // --- 1. Generar VariaciÃ³n Aleatoria Notable ---
    // Generamos un nÃºmero aleatorio entre -15% y +15% del valor base.
    // Esto asegura que el cambio sea visible.
    const rango_variacion = 0.30; // 30% total de rango (-15% a +15%)
    
    // Calcula un factor multiplicador entre 0.85 y 1.15
    const factor_aleatorio = 1 + (Math.random() - 0.5) * rango_variacion; 

    // --- 2. Aplicar la VariaciÃ³n a los Datos de COâ‚‚ ---
    
    // Huella de Carbono por visita (con la variaciÃ³n aleatoria)
    let co2 = CO2_BASE_POR_VISITA * factor_aleatorio;
    
    // Aseguramos que el CO2 no sea negativo
    co2 = Math.max(0, co2); 
    
    // COâ‚‚ por 1000 visitas
    const co2Month = co2 * 1000;

    // --- 3. Actualizar la Interfaz (DOM) ---

    // Los datos transferidos se mantendrÃ¡n fijos (simulaciÃ³n) para que solo varÃ­e el CO2.
    document.getElementById("dataSize").textContent = TAMANO_BASE_KB.toFixed(2) + " KB";
    
    document.getElementById("co2").textContent = co2.toFixed(5);
    document.getElementById("co2Month").textContent = co2Month.toFixed(2);

    dibujarGrafica(co2, co2Month);
};

// La funciÃ³n para dibujar la grÃ¡fica con los nuevos valores (incluye fix para texto)
function dibujarGrafica(co2, co2Month) {
    const canvas = document.getElementById("grafica");
    const ctx = canvas.getContext("2d");
    canvas.width = canvas.offsetWidth;
    canvas.height = 240;

    // Ajuste: si el valor es 0, usamos un mÃ­nimo para que la grÃ¡fica se dibuje.
    const valores = [co2 || 0.00001, co2Month || 0.01]; 
    const etiquetas = ["Por visita", "1000 visitas"];
    const maxValor = Math.max(...valores) || 1;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    valores.forEach((valor, i) => {
        const altura = (valor / maxValor) * 160;
        const x = 90 + i * 200;
        const y = canvas.height - altura - 30;

        ctx.fillStyle = "#16a34a";
        ctx.fillRect(x, y, 100, altura);

        ctx.fillStyle = "#065f46";
        // Mostrar el valor encima de la barra (con el formato correcto de decimales)
        const valorTexto = valor.toFixed(i === 0 ? 5 : 2) + ' g COâ‚‚e';
        ctx.fillText(valorTexto, x, y - 5); 
        ctx.fillText(etiquetas[i], x, canvas.height - 10);
    });
}
</script>


